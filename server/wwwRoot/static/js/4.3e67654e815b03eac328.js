webpackJsonp([4],{"4mxk":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("lC5x"),a=n.n(s),o=n("J0Oq"),r=n.n(o),i=n("4YfN"),u=n.n(i),c=n("9rMa"),l={data:function(){return{cur:1,pageSize:10,total:0,lessons:[],noData:!1}},props:["CommonObj"],methods:u()({},Object(c.b)(["addTag"]),{toAddLesson:function(){this.$router.push("/lesson"),this.addTag({name:"/lesson",label:"我的课程"})},getLesson:function(){var t=this;return r()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/api/lesson/list",{params:{page:t.cur,pageSize:t.pageSize}});case 2:n=e.sent,t.lessons=n.list,t.total=n.total,0==n.list.length?t.noData=!0:t.noData=!1;case 6:case"end":return e.stop()}},e,t)}))()},handleSizeChange:function(t){this.pageSize=t,this.getLesson()},attendance:function(t){this.CommonObj.lessonId=t.id,this.CommonObj.lessonName=t.name,this.CommonObj.series=parseInt(t.attend_count)+1,this.CommonObj.changePage(1)}}),mounted:function(){var t=this;this.$nextTick(function(){t.getLesson()})},activated:function(){var t=this;this.$nextTick(function(){t.getLesson()})}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.noData?n("div",{staticClass:"noDate"},[n("p",[t._v("\n      你暂无无课程，请先"),n("span",{on:{click:t.toAddLesson}},[t._v("导入新课程")])])]):n("div",[n("div",{staticStyle:{width:"100%",overflow:"hidden"}},[n("el-table",{attrs:{data:t.lessons}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"名字",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"teach_time",label:"上课时间",width:"250"}}),t._v(" "),n("el-table-column",{attrs:{prop:"area",label:"上课地点",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"lesson_code",label:"选课课号"}}),t._v(" "),n("el-table-column",{attrs:{label:"考勤",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){t.attendance(e.row)}}},[t._v("开始考勤")])]}}])})],1)],1),t._v(" "),n("el-pagination",{attrs:{"current-page":t.cur,"page-sizes":[10,50,100],background:"","page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"current-change":t.getLesson,"size-change":t.handleSizeChange,"update:currentPage":function(e){t.cur=e}}})],1)])},staticRenderFns:[]};var d=n("Z0/y")(l,m,!1,function(t){n("vgwu")},null,null).exports,p={data:function(){return{num:1,sum:0,students:[]}},props:["CommonObj"],components:{attendTable:n("WAeT").a},methods:{getStudent:function(){var t=this;return r()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.num>t.sum||t.num<0)){e.next=3;break}return t.$message({type:"error",message:"抽取数量只能是1~"+t.sum}),e.abrupt("return");case 3:return e.next=5,t.$http.post("/api/record/getRandom",{id:t.CommonObj.lessonId,num:t.num});case 5:n=e.sent,t.students=n.list;case 7:case"end":return e.stop()}},e,t)}))()},getSum:function(){var t=this;return r()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/api/student/listSum",{params:{id:t.CommonObj.lessonId}});case 2:n=e.sent,t.sum=n.total;case 4:case"end":return e.stop()}},e,t)}))()},handleSubmit:function(){var t=this;this.$confirm("确认要提交本次考勤吗？").then(function(e){t.sumbit()}).catch(function(t){})},sumbit:function(){var t=this;return r()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.students.length)){e.next=9;break}if(void 0!=t.students[n].attend_condition){e.next=6;break}return t.$message({type:"error",message:"请确保每个抽取的同学都选中一种考勤状态！！"}),e.abrupt("return");case 6:n++,e.next=1;break;case 9:return e.next=11,t.$http.post("/api/record/submit",{series:t.CommonObj.series,lid:t.CommonObj.lessonId,list:t.students});case 11:t.$message({type:"success",message:"考勤成功！！"}),t.CommonObj.changePage(0);case 13:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;this.$nextTick(function(){t.getSum()})},activated:function(){var t=this;this.$nextTick(function(){t.getSum()})}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"attend-list"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.CommonObj.changePage(0)}}},[t._v("返回")]),t._v(" "),n("hr"),t._v(" "),n("h1",[t._v(t._s(t.CommonObj.lessonName)+"：第"+t._s(t.CommonObj.series)+"次考勤")]),t._v(" "),n("div",{staticClass:"txt"},[n("span",[t._v("课程共有"+t._s(t.sum)+"名学生，抽取")]),t._v(" "),n("el-input",{attrs:{type:"number",max:t.sum,min:1,size:"small"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),t._v(" "),n("span",[t._v("人")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.getStudent}},[t._v("抽查")])],1),t._v(" "),t.students.length>0?n("div",[n("attendTable",{attrs:{list:t.students}}),t._v(" "),n("el-button",{staticClass:"attend-btn",attrs:{size:"small",type:"primary"},on:{click:t.handleSubmit}},[t._v("确定考勤")])],1):t._e()],1)},staticRenderFns:[]};var v={data:function(){return{showStatus:0,commonSpace:{lessonId:"",lessonName:"",series:"",changePage:this.changePage.bind(this)}}},methods:{changePage:function(t){this.showStatus=t}},components:{lessonComp:d,listComp:n("Z0/y")(p,h,!1,function(t){n("88VW")},null,null).exports}},f={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[0==this.showStatus?e("lessonComp",{attrs:{CommonObj:this.commonSpace}}):this._e(),this._v(" "),1==this.showStatus?e("listComp",{attrs:{CommonObj:this.commonSpace}}):this._e()],1)},staticRenderFns:[]};var b=n("Z0/y")(v,f,!1,function(t){n("uFNr")},null,null);e.default=b.exports},"88VW":function(t,e){},uFNr:function(t,e){},vgwu:function(t,e){}});
//# sourceMappingURL=4.3e67654e815b03eac328.js.map